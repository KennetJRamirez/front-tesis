<h2 class="titulo">Pedidos Activos</h2>

<div class="grid-pedidos">
  <mat-card *ngFor="let pedido of pedidos" class="pedido-card mat-elevation-z6">
    <mat-card-header>
      <div mat-card-avatar class="pedido-avatar">
        <mat-icon>local_shipping</mat-icon>
      </div>
      <mat-card-title>Pedido #{{ pedido.id_pedido }}</mat-card-title>
      <mat-card-subtitle>
        <mat-chip-set>
          <mat-chip color="primary" selected>{{ pedido.estado }}</mat-chip>
        </mat-chip-set>
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <!-- Info del paquete -->
      <p><mat-icon>inventory_2</mat-icon> <strong>Paquete:</strong> {{ pedido.paquete.descripcion }}</p>
      <p><mat-icon>fitness_center</mat-icon> <strong>Peso:</strong> {{ pedido.paquete.peso }} kg</p>
      <p><mat-icon>straighten</mat-icon> <strong>Dimensiones:</strong> {{ pedido.paquete.dimensiones }}</p>

      <mat-divider></mat-divider>

      <!-- Origen -->
      <p><mat-icon>home</mat-icon> <strong>Origen:</strong><br>
        {{ pedido.direccion_origen.calle_principal }} {{ pedido.direccion_origen.numero }},
        {{ pedido.direccion_origen.colonia_o_barrio }}, Zona {{ pedido.direccion_origen.zona }}
      </p>

      <!-- Destino -->
      <p><mat-icon>location_on</mat-icon> <strong>Destino:</strong><br>
        {{ pedido.direccion_destino.calle_principal }} {{ pedido.direccion_destino.numero }},
        {{ pedido.direccion_destino.colonia_o_barrio }}, Zona {{ pedido.direccion_destino.zona }}
      </p>

      <mat-divider></mat-divider>

      <!-- Destinatario -->
      <p><mat-icon>person</mat-icon> <strong>Destinatario:</strong> {{ pedido.destinatario.nombre }}</p>
      <p><mat-icon>phone</mat-icon> <strong>Teléfono:</strong> {{ pedido.destinatario.telefono }}</p>
      <p><mat-icon>email</mat-icon> <strong>Email:</strong> {{ pedido.destinatario.email }}</p>
    </mat-card-content>

    <mat-card-actions align="end">
      <!-- Flujo de botones -->
      <button mat-stroked-button color="primary" (click)="iniciarRecoleccion(pedido.id_envio)">
        <mat-icon>my_location</mat-icon> Iniciar Recolección
      </button>

      <button mat-stroked-button color="accent" (click)="marcarRecolectado(pedido.id_envio)">
        <mat-icon>check</mat-icon> Recolectado
      </button>

      <button mat-raised-button color="primary" (click)="iniciarEntrega(pedido.id_envio)">
        <mat-icon>my_location</mat-icon> Iniciar Entrega
      </button>

      <button mat-raised-button color="warn" (click)="marcarEntregado(pedido.id_envio)">
        <mat-icon>done_all</mat-icon> Entregado
      </button>
    </mat-card-actions>
  </mat-card>
</div>
